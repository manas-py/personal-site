<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Personal Site — Layered Scene (overlay, ads @ 100%, lights sequence)</title>
<style>
  :root{
    /* Overlay intensity for BOTH pc and mobile */
    --overlay-opacity: 2.0;
    --overlay-blend: overlay;
  }

  html,body{
    margin:0; height:100%; width:100%;
    overflow:hidden; background:#000;
    font-family:system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial;
  }

  /* ======= SCENE ======= */
  .scene{
    position:relative;
    width:100vw; height:100vh; min-height:100dvh;
    overflow:hidden; isolation:isolate;
  }

  /* True layer stack: bg (::before) < lights < stickers < overlay (::after) */
  .scene::before,
  .scene::after{
    content:"";
    position:absolute; inset:0;
    background-repeat:no-repeat;
    background-size:cover;          /* PC default (mobile overrides where needed) */
    background-position:center;     /* PC default framing */
  }
  .scene::before{ z-index:0; }      /* BACKGROUND */
  .lights{
    position:absolute; inset:0;
    z-index:1;                      /* PNG sequence sits above bg, below stickers */
    background-repeat:no-repeat;
    background-position:center;     /* keep image centered */
    background-size:auto;           /* 100% native pixel size (no scaling) */
    pointer-events:none;            /* never intercept clicks */
    image-rendering:auto;           /* keep quality */
    opacity:1;
  }
  .slot{ z-index:2; }               /* STICKERS */
  .scene::after{
    z-index:3;                      /* OVERLAY that blends */
    pointer-events:none;
    mix-blend-mode:var(--overlay-blend);
    opacity:var(--overlay-opacity);
  }

  /* ======= DEVICE SCENES ======= */
  /* PC: stable framing you liked (slightly higher) */
  .pc::before{ background-image:url('/pc/bg.png'); background-position:center top -8%; }
  .pc .lights{ background-position:center top -8%; } /* align lights with bg */
  .pc::after { background-image:url('/pc/overlay.png'); background-position:center top -8%; }

  /* Mobile: fit by WIDTH (top/bottom may crop) and overlay also at 2.0 */
  .mobile::before{ background-image:url('/mobile/bg.png'); }
  .mobile .lights{ /* sequence frames also native size, centered */ }
  .mobile::after { background-image:url('/mobile/overlay.png'); }

  /* Responsive switch: PC default, Mobile under 800px */
  .pc{display:block;} .mobile{display:none;}
  @media (max-width:800px){
    .pc{display:none;} .mobile{display:block;}
    .mobile::before, .mobile::after{
      background-size:100% auto;      /* fit width exactly */
      background-position:top center; /* show more top; crop vertically if needed */
    }
    .mobile .lights{
      background-size:auto;           /* keep 1:1 pixel size for sequence */
      background-position:center;     /* center the native-size frame */
    }
  }

  /* ======= STICKERS (ads + buy/download as images) ======= */
  .slot{
    position:absolute;
    /* no width here → elements render at their INTRINSIC size (100% of image size) */
    top:var(--t); left:var(--l);
  }
  .sticker{ display:inline-block; text-decoration:none; outline:none; cursor:pointer; }
  .sticker img{
    display:block;
    width:auto; height:auto;         /* show at native pixel size */
    filter:drop-shadow(0 4px 8px rgba(0,0,0,.30));
  }

  /* -------- Desktop default positions (tweak freely) -------- */
  .pc .slot-1{ --t:8%;   --l:12%; }  /* FiradPatra */
  .pc .slot-2{ --t:7%;   --l:37%; }  /* Welcome / Post */
  .pc .slot-3{ --t:7%;   --l:70%; }  /* Kathmandu */
  .pc .slot-4{ --t:36%;  --l:22%; }  /* YouTube */
  .pc .slot-5{ --t:36%;  --l:69%; }  /* Px1rt */
  .pc .slot-6{ --t:11.5%;--l:74%; }  /* BUY image near #3 (adjust) */
  .pc .slot-7{ --t:11.5%;--l:79%; }  /* DOWNLOAD image near #3 (adjust) */

  /* -------- Mobile defaults (tweak later) -------- */
  .mobile .slot-1{ --t:6%;  --l:6%;  }
  .mobile .slot-2{ --t:14%; --l:20%; }
  .mobile .slot-3{ --t:8%;  --l:46%; }
  .mobile .slot-4{ --t:54%; --l:8%;  }
  .mobile .slot-5{ --t:55%; --l:62%; }
  .mobile .slot-6{ --t:18%; --l:70%; } /* BUY image on mobile */
  .mobile .slot-7{ --t:18%; --l:78%; } /* DOWNLOAD image on mobile */

  /* ======= Debug (press “d”) ======= */
  body.debug .slot{ outline:2px dashed rgba(255,255,255,.8); }
  body.debug .slot::after{
    content:attr(data-slot);
    position:absolute; top:-.9rem; left:-.9rem;
    background:#ff2; color:#111; border-radius:6px; padding:.25rem .35rem;
    font:600 12px/1.2 ui-monospace,SFMono-Regular,Menlo,Consolas,monospace;
    box-shadow:0 2px 6px rgba(0,0,0,.25);
  }
</style>
</head>
<body>

<!-- ========== PC SCENE ========== -->
<section class="scene pc" aria-label="Desktop scene with layered background and animated lights">
  <!-- Lights PNG sequence (native size, centered) -->
  <div class="lights" aria-hidden="true"></div>

  <!-- Five ads as stickers at native size -->
  <div class="slot slot-1" data-slot="#1">
    <a class="sticker" href="#" aria-label="FiradPatra"><img src="/pc/fp.png" alt="FiradPatra"></a>
  </div>
  <div class="slot slot-2" data-slot="#2">
    <a class="sticker" href="#" aria-label="Welcome / Post"><img src="/pc/post.png" alt="Welcome / Post"></a>
  </div>
  <div class="slot slot-3" data-slot="#3">
    <a class="sticker" href="#" aria-label="Kathmandu"><img src="/pc/ktm.png" alt="Kathmandu"></a>
  </div>
  <div class="slot slot-4" data-slot="#4">
    <a class="sticker" href="#" aria-label="YouTube"><img src="/pc/yt.png" alt="YouTube"></a>
  </div>
  <div class="slot slot-5" data-slot="#5">
    <a class="sticker" href="#" aria-label="Px1rt"><img src="/pc/px1rt.png" alt="Px1rt"></a>
  </div>

  <!-- BUY / DOWNLOAD as their own clickable images (no buttons) -->
  <div class="slot slot-6" data-slot="#buy">
    <a class="sticker" href="#" target="_blank" rel="noopener" aria-label="Buy">
      <img src="/pc/buy.png" alt="Buy">
    </a>
  </div>
  <div class="slot slot-7" data-slot="#download">
    <a class="sticker" href="/ktm.pdf" download aria-label="Download Kathmandu PDF">
      <img src="/pc/download.png" alt="Download">
    </a>
  </div>
</section>

<!-- ========== MOBILE SCENE ========== -->
<section class="scene mobile" aria-label="Mobile scene with layered background and animated lights">
  <div class="lights" aria-hidden="true"></div>

  <div class="slot slot-1" data-slot="#1">
    <a class="sticker" href="#" aria-label="FiradPatra"><img src="/mobile/fp.png" alt="FiradPatra"></a>
  </div>
  <div class="slot slot-2" data-slot="#2">
    <a class="sticker" href="#" aria-label="Welcome / Post"><img src="/mobile/post.png" alt="Welcome / Post"></a>
  </div>
  <div class="slot slot-3" data-slot="#3">
    <a class="sticker" href="#" aria-label="Kathmandu"><img src="/mobile/ktm.png" alt="Kathmandu"></a>
  </div>
  <div class="slot slot-4" data-slot="#4">
    <a class="sticker" href="#" aria-label="YouTube"><img src="/mobile/yt.png" alt="YouTube"></a>
  </div>
  <div class="slot slot-5" data-slot="#5">
    <a class="sticker" href="#" aria-label="Px1rt"><img src="/mobile/px1rt.png" alt="Px1rt"></a>
  </div>

  <!-- BUY / DOWNLOAD as images on mobile -->
  <div class="slot slot-6" data-slot="#buy">
    <a class="sticker" href="#" target="_blank" rel="noopener" aria-label="Buy">
      <img src="/mobile/buy.png" alt="Buy">
    </a>
  </div>
  <div class="slot slot-7" data-slot="#download">
    <a class="sticker" href="/ktm.pdf" download aria-label="Download Kathmandu PDF">
      <img src="/mobile/download.png" alt="Download">
    </a>
  </div>
</section>

<script>
/* PNG LIGHTS SEQUENCE (no libraries)
   - Place frames at:
       pc/lights/lights0000.png ... lights0015.png
       mobile/lights/lights0000.png ... lights0015.png
   - Images are rendered at 100% native size (no scaling) via CSS (background-size:auto)
   - Loop forever at the given FPS
*/
(function(){
  const FRAME_COUNT = 16;     // 0000..0015 (inclusive)
  const FPS_PC = 12;
  const FPS_MOBILE = 12;

  function pad4(n){ return String(n).padStart(4,'0'); }

  function buildFrameList(kind){
    const base = `/${kind}/lights/lights`;
    const list = [];
    for(let i=0;i<FRAME_COUNT;i++){
      list.push(`${base}${pad4(i)}.png`);
    }
    return list;
  }

  function startLoop(sceneEl, frames, fps){
    if(!sceneEl) return;
    const layer = sceneEl.querySelector('.lights');
    if(!layer) return;

    let i = 0, last = 0, interval = 1000/Math.max(1,fps);

    function step(ts){
      if(!last){ last = ts; }
      const dt = ts - last;
      if(dt >= interval){
        layer.style.backgroundImage = `url("${frames[i]}")`;
        i = (i + 1) % frames.length;
        last = ts;
      }
      requestAnimationFrame(step);
    }
    requestAnimationFrame(step);
  }

  // Preload frames (best-effort) then start
  function preload(frames){
    return Promise.all(frames.map(u => new Promise(res=>{
      const im = new Image();
      im.onload = ()=>res(true);
      im.onerror = ()=>res(false);
      im.src = u + `?v=${Date.now()
